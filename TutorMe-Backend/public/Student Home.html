<!--A Design by W3layouts
Author: W3layout
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<head>
<title>Student Home</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="css/StyleStudent.css" rel="stylesheet" type="text/css" media="all" />
    <link href="css/nav.css" rel="stylesheet" type="text/css" media="all" />
    <link href='http://fonts.googleapis.com/css?family=Carrois+Gothic+SC' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="js/jquery.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.1/js/materialize.min.js"></script>
    <script type="text/javascript" src="js/login.js"></script>
    <script type="text/javascript" src="js/Chart.js"></script>
    <script type="text/javascript" src="js/jquery.easing.js"></script>
    <script type="text/javascript" src="js/jquery.ulslide.js"></script>
    <script src="js/materialize.clockpicker.js"></script>
    <link rel="stylesheet" href="css/materialize.clockpicker.css" />
    <!----Calender -------->
    <link rel="stylesheet" href="css/clndr.css" type="text/css" />
    <script src="js/underscore-min.js"></script>
    <script src="js/moment-2.2.1.js"></script>
    <script src="js/clndr.js"></script>
    <script src="js/site.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.1/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.4.0/fullcalendar.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.4.0/fullcalendar.min.css">
    
    <!----End Calender -------->
</head>



</script>

<body>			       
	    <div class="wrap">	 
	      <div class="header">
	      	  <div class="header_top">
					  <div class="menu">
						  <a class="toggleMenu" href="#"><img src="images/nav.png" alt="" /></a>
							<ul class="nav">
<!--								<li><a href="#"><i><img src="images/settings.png" alt="" /></i>Settings</a></li>-->
								<li class="active"><a href="#"><i><img src="images/user.png" alt="" /></i>Student</a></li>
<!--                                <li><a class="dropdown-button" href="#" data-activates="requests_dropdown"><i><img src="images/mail.png" alt="" /></i>Requests <span class="messages">2</span></a></li>-->
                                <li><a class="modal-trigger" id="scheduleButton" href="#schedule_modal"><i><img src="images/events.png" alt="" /></i>Schedule</a></li>
                                <li><a class="modal-trigger" href="#appointments_modal"><i><img src="images/follow_user.png" alt="" /></i>Request Appointment</a></li>
                                
                                <!-- Modal Structure  for viewing schedule-->
                        <div id="schedule_modal" class="modal">
                            <div class="modal-content">
                                <div class="container">
                                    <div class="row">

                                        <span class="col s12 center-align"><b>Schedule</b></span>
                                        

                                        
                                        <div class="col s12 center-align">&nbsp;</div>
<!--
                                        <div class="col s12 center-align">
                                            <input type="checkbox" name="emailProf" value="Yes" id="professor_toggle" onclick="toggleProfessors()" />
                                            <label for="professor_toggle"> Email Professor</label>


                                        </div>
-->
<!--
                                        <div id="professor_box" class="col s12 center-align"></div>
                                        <div class="col s12 center-align">&nbsp;</div>
-->
<!--
                                        <div class="col s12 center-align">
                                            <button type="button" onclick="viewStudentSchedule()">Login Student</button>

                                        </div>
-->
<!--
                                        <div class="col s12 center-align">&nbsp;</div>
                                        <div class="col s12 center-align">&nbsp;</div>
-->
                                        <div class="col s12 center-align"><b> </b></div>
                                        <div class="divider col s12"></div>
                                        <div class="col s12 center-align">&nbsp;</div>
                                        <div class="col s12 center-align">&nbsp;</div> 
                                        <div class="col s12 center-align">&nbsp;</div>
                                        <div class="col s12 center-align">&nbsp;</div>
                                        <div class="col s12 center-align"><b>Requests awaiting confirmation</b></div>
                                        <div class="divider col s12"></div>

                                        <div id="student_box" class="col s12 center-align">
                                            <table id="loggedInStudents" border="1" style="cursor: pointer;">
                                                
                                            </table>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
                            </div>
                        </div>
                                
                                
                                
                                
                                <!-- Modal Structure for appointments-->
                        <div id="appointments_modal" class="modal">
                            <div class="modal-content">
                                <div class="container">
                                    <div class="row">

                                        <span class="col s12 center-align"><b>Request Appointment</b></span>
                                        
                                        <div class="col s12 center-align">&nbsp;</div>
                                        <div class="col s4 center-align">&nbsp;</div>
                                        
                                        <div class="col s4 center-align">
                                            <input type="date" class="datepicker center-align" placeholder="Date" id="date_box">
                                        </div>
                                        
                                        <div class="col s12 center-align">&nbsp;</div>
                                        <div class="col s4 center-align">&nbsp;</div>
                                        
                                        <div class="col s4 center-align">
                                            <input type="text" class="timepicker center-align" placeholder="Time" id="time_box">
                                        </div>

                                        <div class="col s12 center-align">&nbsp;</div>
                                        <div class="col s4 center-align">&nbsp;</div>
                                        
                                        <div class="col s12 center-align">
                                            <input type="text" class='dropdown-button center-align' data-activates='subject_dropdown' placeholder="Pick a Subject" id="login_box">
                                        </div>

                                            <!-- Dropdown Structure --> 
                                            <ul id='subject_dropdown' class='dropdown-content'>
                                                <li><a href="#!" onclick="pickSubject('Accounting', '0')">Accounting</a></li>
                                                <li><a href="#!" onclick="pickSubject('Business', '1')">Business</a></li>
                                                <li><a href="#!" onclick="pickSubject('Computer Science', '2')">Computer Science</a></li>
                                                <li><a href="#!" onclick="pickSubject('Ecocomics', '3')">Economics</a></li>
                                                <li><a href="#!" onclick="pickSubject('Finance', '4')">Finance</a></li>
                                                <li><a href="#!" onclick="pickSubject('Health & Medical', '5')">Health & Medical</a></li>
                                                <li><a href="#!" onclick="pickSubject('Math', 6)">Math</a></li>
                                                <li><a href="#!" onclick="pickSubject('Music', 7)">Music</a></li>
                                                <li><a href="#!" onclick="pickSubject('Physics', 8)">Physics</a></li>
                                                <li><a href="#!" onclick="pickSubject('Russian', 9)">Russian</a></li>
                                                <li><a href="#!" onclick="pickSubject('Writing', 10)">Writing</a></li>
                                                
                                            </ul>
                                        

                                        <div class="col s12 center-align">&nbsp;</div>
                                        <div class="col s4 center-align">&nbsp;</div>
                                        
                                        <div class="col s12 center-align">
                                            <input type="text" class='dropdown-button center-align' data-activates='tutor_dropdown' placeholder="Pick a Tutor" id="chosen_tutor">
                                        </div>
                                            <!-- Dropdown Structure -->                                        
                                            <ul id='tutor_dropdown' class='dropdown-content'>
                                            </ul>

                                        <div class="col s12 center-align">
<!--                                          <button type="button" onclick="requestAppointment()">Make Request</button>-->
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat" onclick="requestAppointment()">Make Request</a>
                            </div>
                        </div>
                            
							<div class="clear"></div>
						    </ul>
							<script type="text/javascript" src="js/responsive-nav.js"></script>
				        </div>	
					  <div class="profile_details">
				    		   <div id="loginContainer">
				                  <a id="loginButton" class=""><span>Me</span></a>   
				                    <div id="loginBox">                
				                      <form id="loginForm">
				                        <fieldset id="body">
				                            <div class="user-info center-align">
							        			<h4>Hello,<a href="#"> Username</a></h4>
							        			<ul>
							        				<li class="profile active"><a href="#">Profile </a></li>
							        				<li class="logout"><a href="#"> Logout</a></li>
							        				<div class="clear"></div>		
							        			</ul>
							        		</div>			                            
				                        </fieldset>
				                    </form>
				                </div>
				            </div>
<!--
				             <div class="profile_img">	
				             	<a href="#"><img src="images/Empty_profile_small.jpg" alt="" />	</a>
				             </div>		
-->
				             <div class="clear"></div>		  	
					    </div>	
		 		      <div class="clear"></div>				 
				   </div>
			</div>	  					     
	</div>
	  <div class="main">  
	    <div class="wrap">  		  

<!--            <div class="column_middle">-->
              <div class="column_middle_grid1">
		         <div class="profile_picture">
<!--		        	<a href=""><img src="images/Empty_profile.jpg" alt="" /></a>		         -->
		            <div class="profile_picture_name">
		              <h2 id="userName2"></h2>
		            	<p>Student </p>
		            </div>
                  </div>   
		       </div>
                <div class="column_right_grid calender" style="background-color: white">
                         <div id='calendar'> </div>
                     </div>
<!--    	    </div>-->
    	<div class="clear"></div>
 	 </div>
   </div>
    <script>
        
        
        $(document).ready(function () {
            // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
            $('.modal-trigger').leanModal();
        });

        $('.datepicker').pickadate({
            dateFormat: 'yyyy-mm-dd',
            selectMonths: true, // Creates a dropdown to control month
            selectYears: 1 // Creates a dropdown of 1 years to control year
            
        });

        $('.timepicker').pickatime({
            autoclose: true
        });

        $('.dropdown-button').dropdown({
            inDuration: 300,
            outDuration: 225,
            //constrain_width: false, // Does not change width of dropdown to that of the activator
            hover: false, // Activate on hover
            gutter: 0, // Spacing from edge
            belowOrigin: false, // Displays dropdown below the button
            alignment: 'left' // Displays dropdown with edge aligned to the left of button
        });
        
        $(window).load(function() {

    		// page is now ready, initialize the calendar...

    		$('#calendar').fullCalendar({
        	// put your options and callbacks here
        		header: {
				left: 'prev,next today',
				center: 'title',
				right: 'month,basicWeek,basicDay'
			},
//			eventLimit: 2,
			prev: 'left-single-arrow',
        		events: [
        {
            title  : 'Tutoring',
            start  : '2015-11-01'
        },
        {
            title  : 'Tutoring',
            start  : '2015-11-05',
            end    : '2015-11-05'
        },
        {
            title  : 'Joe',
            start  : '2015-11-12'
        },
        {
            title  : 'Bill',
            start  : '2015-11-12'
        },
        {
            title  : 'Casey',
            start  : '2015-11-12'
        },
        {
            title  : 'Bob',
            start  : '2015-11-12'
        }
    ]
    
    
    
    		})

		});
        

        function toggleProfessors() {
            if (document.getElementById("professor_toggle").checked) {
                document.getElementById("professor_box").innerHTML = "List of Professors";

            } else {

                document.getElementById("professor_box").innerHTML = "";
            }
        }
        


        function requestAppointment() {

            if (document.getElementById("login_box").value != "") {
                var table = document.getElementById("loggedInStudents");
                var row = table.insertRow(-1);
                var cell0 = row.insertCell(0);
                var cell1 = row.insertCell(1);
                var cell2 = row.insertCell(2);
                cell0.innerHTML = document.getElementById("date_box").value + " at " + document.getElementById("time_box").value;
                cell1.innerHTML = document.getElementById("login_box").value;
                cell2.innerHTML = document.getElementById("chosen_tutor").value;

                addRowHandlers();

                document.getElementById("date_box").value = "";
                document.getElementById("time_box").value = "";
                document.getElementById("login_box").value = "";
                document.getElementById("chosen_tutor").value = "";
                
                var requestAppointmentQuery = "https://tutorme.stetson.edu/api/tutors/getAll?Subject=CSCI";
                $.getJSON(requestAppointmentQuery, function (data) {
                    console.log(data)
                });
                
                $('#calendar').fullCalendar('renderEvent', {
                    title: "Jeremy Rumsey",
                    start: "2015-12-09T18:00:00"
                }, true);
                alert("Request sent!");
               // document.getElementById("professor_toggle").checked = false;
               // toggleProfessors();
                
                addAppointment();
            }

            //from http://jsfiddle.net/oh16h7cj/ | http://stackoverflow.com/questions/1207939/adding-an-onclick-event-to-a-table-row, adapted to my situation
            function addRowHandlers() {
                var table = document.getElementById("loggedInStudents");
                var rows = table.getElementsByTagName("tr");
                for (i = 0; i < rows.length; i++) {
                    var currentRow = table.rows[i];
                    var createClickHandler =
                        function (row) {
                            return function () {
                                var cell = row.getElementsByTagName("td")[0];
                                var id = cell.innerHTML;

                                //removeRow(id);
                                resendRequest(id);
                                
                            };
                        };

                    currentRow.onclick = createClickHandler(currentRow);
                }
            }

            function removeRow(id) {
                var table = document.getElementById("loggedInStudents");
                var rows = table.getElementsByTagName("tr");



                for (i = 0; i < rows.length; i++) {
                    //alert(document.getElementById("loggedInStudents").getElementsByTagName("tr")[0].innerHTML);

                    var currentRow = table.rows[i];
                    var cell = currentRow.getElementsByTagName("td")[0];
                    var tID = cell.innerHTML;
                    //alert(currentRow.row.getElementsByTagName("td")[0])
                    //alert(table.rows[i].cells[0].innerhtml);
                    if (tID == id) {
                        table.deleteRow(i);


                    }
                }

//                if (rows.length == 0) {
//                    document.getElementById("scheduleButton").innerHTML = "<i><img src=\"images/loginArrow.png\" alt=\"\" /></i> Start Session"
//
//                }


            }
            
        }
        

    var subjectArray = ["Accounting", "Business", "Computer Science", "Economics", "Finance", "Health & Medical", "Math", "Music", "Physics", "Russian", "Writing"];
    var accountingTutors;// = ["Bob", "Tim", "Lesz"];
    var businessTutors;// = ["Hamlet", "George"];
    var computerScienceTutors = ["Brandon Edwards", "Michael Clay"];
    var economicsTutors;// = ["Hope", "Dameon", "Larkin"];
    var financeTutors;// = ["Rose", "Daisy", "Penelope"];
    var healthTutors;// =  ["James", "Neil", "Eric"];
    var mathTutors;// = ["Matt", "Gerken"];
    var musicTutors;// = ["Jazmin", "Neil", "Chris"];
    var physicsTutors;// = ["Tyler", "Ari", "Jamontee"];
    var russianTutors;// = ["Poop", "Peter", "Gerogia"];
    var writingTutors;// = ["Melaina", "Vanessa", "Erica"];
    

     function pickSubject(subject, tutors) {

        if(subjectArray[tutors] == "Accounting") {
            subjectTutors = accountingTutors;
//            var requestAppointmentQuery = "https://tutorme.stetson.edu/api/tutors/getAll?Subject=ACCT";
//                $.getJSON(requestAppointmentQuery, function (data) {
//                    console.log(data)
//                });
//            for(i = 0; i < data.result.length; i++)
//                {
//                    computerScienceTutors.push(data.result[9]);
//                }
        }
        else if(subjectArray[tutors] == "Business") {
            subjectTutors = businessTutors;   
        }
        else if(subjectArray[tutors] == "Computer Science") {
            subjectTutors = computerScienceTutors;
//            var requestAppointmentQuery = "https://tutorme.stetson.edu/api/tutors/getAll?Subject=CSCI";
//                $.getJSON(requestAppointmentQuery, function (data) {
//                    console.log(data)
//                });
//            for(i = 0; i < data.result.length; i++)
//                {
//                    computerScienceTutors.push(data.result[9]);
//                }
        }
        else if(subjectArray[tutors] == "Economics") {
            subjectTutors = economicsTutors;
        }
        else if(subjectArray[tutors] == "Finance") {
            subjectTutors = financeTutors;
        }
        else if(subjectArray[tutors] == "Health & Medical") {
            subjectTutors = healthTutors;
        }
        else if(subjectArray[tutors] == "Math") {
            subjectTutors = mathTutors;
        }
        else if(subjectArray[tutors] == "Music") {
            subjectTutors = musicTutors;
        }
        else if(subjectArray[tutors] == "Physics") {
            subjectTutors = physicsTutors;
        }
        else if(subjectArray[tutors] == "Russian") {
            subjectTutors = russianTutors;
        }
        else if(subjectArray[tutors] == "Writing") {
            subjectTutors = writingTutors;
        }

        document.getElementById("login_box").value = subject;
        var subjectTutors;

        var UL = document.getElementById("tutor_dropdown");
        while( UL.firstChild ){
        UL.removeChild(UL.firstChild);
        }

         for (i = 0; i < subjectTutors.length; i++) {
             var ul = document.getElementById("tutor_dropdown");
             var li = document.createElement("li");
             li.appendChild(document.createTextNode(subjectTutors[i]));
             li.onclick = function() {document.getElementById("chosen_tutor").value = this.innerHTML};
             ul.appendChild(li);
         }

    } 
        
    function pickSubject2(subject, tutors) {
        var subjectTutors;
        if(subjectArray[tutors] == "Accounting") {
            subjectTutors = accountingTutors;
        }
        else if(subjectArray[tutors] == "Business") {
            subjectTutors = businessTutors;   
        }
        else if(subjectArray[tutors] == "Computer Science") {
            subjectTutors = computerScienceTutors;     
        }
        else if(subjectArray[tutors] == "Economics") {
            subjectTutors = economicsTutors;
        }
        else if(subjectArray[tutors] == "Finance") {
            subjectTutors = financeTutors;
        }
        else if(subjectArray[tutors] == "Health & Medical") {
            subjectTutors = healthTutors;
        }
        else if(subjectArray[tutors] == "Math") {
            subjectTutors = mathTutors;
        }
        else if(subjectArray[tutors] == "Music") {
            subjectTutors = musicTutors;
        }
        else if(subjectArray[tutors] == "Physics") {
            subjectTutors = physicsTutors;
        }
        else if(subjectArray[tutors] == "Russian") {
            subjectTutors = russianTutors;
        }
        else if(subjectArray[tutors] == "Writing") {
            subjectTutors = writingTutors;
        }
//        document.getElementById("login_box").value = subject;
//        var subjectTutors;

        var UL = document.getElementById("slide2");
        while( UL.firstChild ){
        UL.removeChild(UL.firstChild);
        }
        
         for (i = 0; i < subjectTutors.length; i++) {
             var ul = document.getElementById("slide2");
             var li = document.createElement("li");
             li.appendChild(document.createTextNode(subjectTutors[i]));
             ul.appendChild(li);
         }
        
    } 
        

    function resendRequest(id) {
        var table = document.getElementById("loggedInStudents");
        alert("Resend Request?");

    }

    function addAppointment() {
                var date = document.getElementById("date_box").value;
                var myDate = new Date(date);
                var myTitle = document.getElementById("reason_box").value;

                var year = myDate.getFullYear();

                var month = myDate.getMonth() + 1;

                var day = myDate.getDate();

                if (day < 10) {
                    day = "0" + day;
                }

                if (month < 10) {
                    month = "0" + month;
                }
        
                myTime = time.split(":");

                var hour = parseInt(myTime[0]);

                if (myTime[1].indexOf("PM") != -1) {
                    hour += 12;
                }

                time = "T" + hour + ":" + myTime[1].substring(0, 2) + ":00";

                var finalDate = year + "-" + month + "-" + day + time;

                document.getElementById("date_box").value = "";
                document.getElementById("time_box").value = "";
                document.getElementById("reason_box").value = "";


                  //add formated date to calendar
                $('#calendar').fullCalendar('renderEvent', {
                    title: myTitle,
                    start: finalDate
                }, true);
            }
        
                initUserData();
        
                function initUserData() {
                    $.getJSON('https://tutorme.stetson.edu/user', function (data) {
                    //localStorage.setItem('User', JSON.stringify(data));
                    //var userNameJSON = JSON.parse(data);
                    userName = data.username;

//                    initPendingAppointments();
//                    initSessionButton();
//                    initCalanderEvents();

                    var selfQuery = "https://tutorme.stetson.edu/api/students/get?field=Username&value=" + userName;

                    //grab info about self as student
                    $.getJSON(selfQuery, function (data) {

                        //console.log(data.result[0].Email);
                        firstName = data.result[0].FirstName;
                        lastName = data.result[0].LastName;

                        //set name
                        document.getElementById("userName1").innerHTML = "Hello,<a href=\"Student%20Home.html\">" + " " + userName + "</a>";
                        document.getElementById("userName2").innerHTML = firstName + " " + lastName;
                    });


                });
            };
        
        
    </script>
</body>
</html>

